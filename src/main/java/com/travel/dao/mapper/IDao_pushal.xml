<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "https://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.travel.dao.user.IDao_pushal_user">
	<select id="pushaldelivery" resultType="com.travel.dto.user.DTO_pushal_user">
		<!-- SELECT 	
			B.M_NAME, A.DELIVERY_ADDR 
			FROM 	
				THISDELIVERY A 
			LEFT JOIN 
				TMSTMEMBER B 
				
				ON A.M_NO = B.M_NO 
			WHERE B.M_NO = #{param1}
			ORDER BY EVENT_DATE DESC -->
			SELECT  
				B.M_NAME, D.CODENAME AS STEP_FLAG_STR, A.DELIVERY_ADDR, C.ITEM_NAME 
				FROM    
					THISDELIVERY A  
				LEFT JOIN 
					TMSTMEMBER B  
					ON  A.M_NO = B.M_NO
	            LEFT JOIN TMSTITEM   C  
	            	ON  A.EVENT_NO = C.EVENT_NO
	            AND A.ITEM_NO = C.ITEM_NO
	            LEFT JOIN TMSTCODE   D  
	            	ON  A.STEP_FLAG = D.CODE
	            AND D.GRPCODE = 13                   
				WHERE B.M_NO = #{param1}   
	</select>
	<select id="pushalpayment" resultType="com.travel.dto.user.DTO_pushal_user">
		SELECT 
			B.M_NAME, A.TOTAL_PRICE, A.DISCOUNT_PRICE, A.PAYMENT_PRICE, C.ITEM_NAME
			FROM 
				THISORDER A 
			LEFT JOIN 
				TMSTMEMBER B 
				
				ON A.M_NO = B.M_NO
	        LEFT JOIN 
	        	TMSTITEM   C 
	        	
	        	ON A.ORDER_NO = C.ITEM_NO
			WHERE B.M_NO = #{param1}
	</select>
	<select id="pushalrefund" resultType="com.travel.dto.user.DTO_pushal_user">
		SELECT 
			D.S_NAME, C.M_NAME, A.REFUND_REASON, A.REFUND_PRICE,
			A.REFUND_PERCENTAGE, A.STEP_FLAG, A.STEP1_DATE, A.STEP2_DATE 
			FROM THISREFUND A 
			LEFT JOIN THISORDER B 
				ON A.ORDER_NO = B.ORDER_NO
	        LEFT JOIN TMSTMEMBER C 
	        	ON A.ORDER_NO = C.M_NO
	        LEFT JOIN TMSTSTAY   D 
	        	ON D.S_NO = A.S_NO
			WHERE C.M_NO = #{param1}
	</select>
</mapper>